\hfuzz=1pt % Don't complain of overfull boxes by less than 1pt.
\overfullrule=2cm % Make overfull rule more visible.

% Language support.
\usepackage{polyglossia}
\setdefaultlanguage{english}

% Font setup.
\usepackage{fontspec}
\defaultfontfeatures{
    Path=typefaces/Reforma1918/,
    Numbers={OldStyle,Proportional}
}
\setmainfont[
    ItalicFont=Reforma1918-GrisItalica,
    BoldFont=Reforma1918-Negra,
]{Reforma1918-Gris.otf}
\newfontfamily{\lightfont}[ % Typeface for headings
    ItalicFont=Reforma1918-BlancaItalica.otf
]{Reforma1918-Blanca.otf}
% Line spacing multiplication factor
\linespread{1.05}

\frenchspacing % Don't add extra space after periods

\usepackage{microtype} % Microtypografic enhancements

% Global class options.
\KOMAoptions{
    draft = false,
    paper = 5in:8in,
    BCOR = 8.25mm, % Binding correction
    twoside = true,
    fontsize = {11},
    toc = left, % ToC Style
    chapterprefix = true, % Add "chapter" prefix
    headings = small,
    numbers = noendperiod,
    headsepline = true, % Header line
    footinclude = true, % Include footer in type area
    headinclude = true, % Include header in type area
    DIV = 20, % Type area size, for an explanation look at Koma-Script guide
}

\usepackage{lengthconvert} % For the dimensions page
\usepackage{showframe}

\usepackage{scrlayer}

\setkomafont{disposition}{\normalcolor}
\setkomafont{part}{\fontsize{27}{27}\selectfont}

\renewcommand\chapterlineswithprefixformat[3]{%
    \lightfont%
    #2\LARGE\addfontfeature{LetterSpace=4.0}\MakeUppercase{#3}%
}
\renewcommand\partlineswithprefixformat[3]{%
    \lightfont\itshape%
    \addfontfeature{LetterSpace=2.0}\MakeUppercase{#3}%
}

\setcounter{tocdepth}{\parttocdepth} % Only show parts in ToC
% Style of part entries in ToC
\RedeclareSectionCommand[
  tocnumwidth=0pt,
  tocnumsep=0pt,
  tocindent=0pt,
  tocentrynumberformat=\gobbleentrynumber,
  tocraggedpagenumber=true,
  toclinefill=\hspace{1em},
]{part}
\newcommand*\gobbleentrynumber[1]{\hspace{-1.1em}} % See tocentrynumberformat above

% Hyperlinks
\usepackage{hyperref} 
\hypersetup{colorlinks=true,allcolors=black}

% Tighter lists osed by pandoc
\newcommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% Handy command to add book title to header
\newcommand{\titlemark}{\markright{Swimming Backwards}}
